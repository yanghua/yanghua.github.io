<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="google-site-verification" content="6q22x_DFglYGJjD5t1d95nBYd_U8cDU04B-Haky8KHs" />
  <meta name="baidu-site-verification" content="yEdVDDBr1C" />
  
  <title>Apache Flink源码解析之stream-operator | yanghua</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="前面我们谈论了Flink stream中的transformation。你可以将transformation看成编写Flink程序并构建流式处理程序的必要组成部分（静态表现形式）；而本篇我们将探讨transformation在Flink运行时对应的动态表现形式——operator。他们之间的映射关系见下图：">
<meta property="og:type" content="article">
<meta property="og:title" content="Apache Flink源码解析之stream-operator">
<meta property="og:url" content="http://vinoyang.com/2016/05/21/flink-stream-operator/index.html">
<meta property="og:site_name" content="yanghua">
<meta property="og:description" content="前面我们谈论了Flink stream中的transformation。你可以将transformation看成编写Flink程序并构建流式处理程序的必要组成部分（静态表现形式）；而本篇我们将探讨transformation在Flink运行时对应的动态表现形式——operator。他们之间的映射关系见下图：">
<meta property="og:image" content="http://7xkaaz.com1.z0.glb.clouddn.com/flink-concepts_program-dataflow.png">
<meta property="og:image" content="http://7xkaaz.com1.z0.glb.clouddn.com/flink-stream-operator_all-class-diagram.png">
<meta property="og:image" content="http://7xkaaz.com1.z0.glb.clouddn.com/flink-stream-operator_streamsource.png">
<meta property="og:image" content="http://7xkaaz.com1.z0.glb.clouddn.com/Apache_Flink_weixin.jpg">
<meta property="og:image" content="http://7xkaaz.com1.z0.glb.clouddn.com/qrcode_for_apache_flink_qq_group.png">
<meta property="og:updated_time" content="2016-05-21T14:42:49.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Apache Flink源码解析之stream-operator">
<meta name="twitter:description" content="前面我们谈论了Flink stream中的transformation。你可以将transformation看成编写Flink程序并构建流式处理程序的必要组成部分（静态表现形式）；而本篇我们将探讨transformation在Flink运行时对应的动态表现形式——operator。他们之间的映射关系见下图：">
<meta name="twitter:image" content="http://7xkaaz.com1.z0.glb.clouddn.com/flink-concepts_program-dataflow.png">
  
    <link rel="alternative" href="/atom.xml" title="yanghua" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  <!-- <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css"> -->
  <link rel="stylesheet" href="/css/style.css">
  

</head>
<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">yanghua</a>
      </h1>
      
        <h2 id="subtitle-wrap">
          <a href="/" id="subtitle">alone coder</a>
        </h2>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
          <a class="main-nav-link" href="/projects">Projects</a>
        
          <a class="main-nav-link" href="/about">About</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-github-link" class="nav-icon" href="https://github.com/yanghua" target="_blank" title="GitHub"></a>
        
        
          <a id="nav-weibo-link" class="nav-icon" href="http://weibo.com/yanghua1127" target="_blank" title="Sina Weibo"></a>
        
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" results="0" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://vinoyang.com"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main"><article id="post-flink-stream-operator" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/05/21/flink-stream-operator/" class="article-date">
  <time datetime="2016-05-21T14:40:51.000Z" itemprop="datePublished">2016-05-21</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      Apache Flink源码解析之stream-operator
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <!-- Table of Contents -->
        
          <div id="toc" class="toc-article">
            <strong class="toc-title">文章目录</strong>
            <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#StreamOperator"><span class="toc-number">1.</span> <span class="toc-text">StreamOperator</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#StreamSource"><span class="toc-number">1.1.</span> <span class="toc-text">StreamSource</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#NonTimestampContext"><span class="toc-number">1.1.1.</span> <span class="toc-text">NonTimestampContext</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ManualWatermarkContext"><span class="toc-number">1.1.2.</span> <span class="toc-text">ManualWatermarkContext</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#AutomaticWatermarkContext"><span class="toc-number">1.1.3.</span> <span class="toc-text">AutomaticWatermarkContext</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#OneInputStreamOperator"><span class="toc-number">1.2.</span> <span class="toc-text">OneInputStreamOperator</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#TwoInputStreamOperator"><span class="toc-number">1.3.</span> <span class="toc-text">TwoInputStreamOperator</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#辅助实现类"><span class="toc-number">1.4.</span> <span class="toc-text">辅助实现类</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Output"><span class="toc-number">1.4.1.</span> <span class="toc-text">Output</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#TimeCharacteristic"><span class="toc-number">1.4.2.</span> <span class="toc-text">TimeCharacteristic</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#TimestampedCollector"><span class="toc-number">1.4.3.</span> <span class="toc-text">TimestampedCollector</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#AbstractStreamOperator"><span class="toc-number">1.4.4.</span> <span class="toc-text">AbstractStreamOperator</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#AbstractUdfStreamOperator"><span class="toc-number">1.4.5.</span> <span class="toc-text">AbstractUdfStreamOperator</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ChainingStrategy"><span class="toc-number">1.4.6.</span> <span class="toc-text">ChainingStrategy</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#内置的Operator实现"><span class="toc-number">1.5.</span> <span class="toc-text">内置的Operator实现</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#StreamCounter"><span class="toc-number">1.5.1.</span> <span class="toc-text">StreamCounter</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#StreamProject"><span class="toc-number">1.5.2.</span> <span class="toc-text">StreamProject</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#StreamFilter"><span class="toc-number">1.5.3.</span> <span class="toc-text">StreamFilter</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#StreamMap"><span class="toc-number">1.5.4.</span> <span class="toc-text">StreamMap</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#StreamFlatMap"><span class="toc-number">1.5.5.</span> <span class="toc-text">StreamFlatMap</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#StreamGroupedFold"><span class="toc-number">1.5.6.</span> <span class="toc-text">StreamGroupedFold</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#StreamGroupedReduce"><span class="toc-number">1.5.7.</span> <span class="toc-text">StreamGroupedReduce</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#StreamSink"><span class="toc-number">1.5.8.</span> <span class="toc-text">StreamSink</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#小结"><span class="toc-number">2.</span> <span class="toc-text">小结</span></a></li></ol>
          </div>
        
        <p>前面我们谈论了Flink stream中的transformation。你可以将<code>transformation</code>看成编写Flink程序并构建流式处理程序的必要组成部分（<strong>静态表现形式</strong>）；而本篇我们将探讨<code>transformation</code>在Flink运行时对应的<strong>动态表现形式</strong>——operator。他们之间的映射关系见下图：</p>
<a id="more"></a>
<p><img src="http://7xkaaz.com1.z0.glb.clouddn.com/flink-concepts_program-dataflow.png" alt="flink-stream-operator_transformation-operator"></p>
<blockquote>
<p>具体的探讨可以查看前文：Flink中的一些核心概念</p>
</blockquote>
<h1 id="StreamOperator"><a href="#StreamOperator" class="headerlink" title="StreamOperator"></a>StreamOperator</h1><p>所有<code>operator</code>的最终基类，<code>operator</code>的分类方式，按照输入流个数不同分为：</p>
<ul>
<li>无输入：StreamSource</li>
<li>单个流输入：OneInputStreamOperator</li>
<li>两个流输入：TwoInputStreamOperator</li>
</ul>
<p>跟生命周期有关的核心抽象方法：</p>
<ul>
<li>setup ： 实例化<code>operator</code></li>
<li>open ：该方法会在任何元素被处理之前执行，它的实现通常包含了<code>operator</code>的初始化逻辑</li>
<li>close ：该方法在所有的元素都进入到<code>operator</code>被处理之后调用</li>
<li>dispose ：该方法在<code>operator</code>生命周期的最后阶段执行，主要用于回收资源</li>
</ul>
<blockquote>
<p><code>StreamOperator</code>及其实现类中还包含了一些状态恢复与保存相关的逻辑，但这些不是本文的主题，所有暂时不做探讨。</p>
</blockquote>
<p>先来看一下整个package的类关系图：</p>
<p><img src="http://7xkaaz.com1.z0.glb.clouddn.com/flink-stream-operator_all-class-diagram.png" alt="flink-stream-operator_all-class-diagram"></p>
<p>我们整个剖析方式大致也按照以上<code>operator</code>的分类方式以及类的层次结构来。</p>
<h2 id="StreamSource"><a href="#StreamSource" class="headerlink" title="StreamSource"></a>StreamSource</h2><p>作为一个流处理DAG的起点，<code>source operator</code>相比其他<code>operator</code>无疑是特别的（从类的继承关系图也可以看出来）。</p>
<p>它需要接受<code>SourceFunction</code>的实例。并且我们可以看到，它的<code>chaining strategy</code>是<code>HEAD</code>（它表示<code>operator</code>不能有前置<code>operator</code>，但可以作为其他<code>operator</code>的前置<code>operator</code>，下文会谈到）。</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">this</span>.chainingStrategy = ChainingStrategy.HEAD;</div></pre></td></tr></table></figure>
<p><code>StreamSource</code>的实现略显复杂，因为它涉及到我们前面文章谈<code>SourceFunction</code>时谈到的<code>SourceFunction.SourceContext</code>的实现。在这里提供了三个实现，分别对应我们之前谈到的Flink对事件时间的三个分类：</p>
<p><img src="http://7xkaaz.com1.z0.glb.clouddn.com/flink-stream-operator_streamsource.png" alt="flink-stream-operator_streamsource"></p>
<ul>
<li>NonTimestampContext:针对<code>ProcessingTime</code>，该<code>SourceContext</code>将时间戳设置为<strong>-1</strong>，并且不发射<code>watermark</code></li>
<li>AutomaticWatermarkContext:针对<code>IngestionTime</code>，提供自动的<code>watermark</code>发射机制的<code>SourceContext</code></li>
<li>ManualWatermarkContext:针对<code>EventTime</code>的人工发射<code>watermark</code>的<code>SourceContext</code></li>
</ul>
<p>它们之间的对应关系也体现在其<code>run</code>方法的实现中：</p>
<figure class="highlight aspectj"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">switch</span> (timeCharacteristic) &#123;</div><div class="line">	<span class="keyword">case</span> EventTime:</div><div class="line">		ctx = <span class="keyword">new</span> ManualWatermarkContext&lt;&gt;(<span class="keyword">this</span>, lockingObject, collector);</div><div class="line">		<span class="keyword">break</span>;</div><div class="line">	<span class="keyword">case</span> IngestionTime:</div><div class="line">		ctx = <span class="keyword">new</span> AutomaticWatermarkContext&lt;&gt;(<span class="keyword">this</span>, lockingObject, collector,</div><div class="line">				getRuntimeContext().getExecutionConfig().getAutoWatermarkInterval());</div><div class="line">		<span class="keyword">break</span>;</div><div class="line">	<span class="keyword">case</span> ProcessingTime:</div><div class="line">		ctx = <span class="keyword">new</span> NonTimestampContext&lt;&gt;(<span class="keyword">this</span>, lockingObject, collector);</div><div class="line">		<span class="keyword">break</span>;</div><div class="line">	<span class="keyword">default</span>:</div><div class="line">		<span class="keyword">throw</span> <span class="keyword">new</span> Exception(String.valueOf(timeCharacteristic));</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>在<code>run</code>方法内部会调用<code>SourceFunction</code>的<code>run</code>方法：</p>
<figure class="highlight arduino"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">try</span> &#123;</div><div class="line">			userFunction.<span class="built_in">run</span>(ctx);</div><div class="line"></div><div class="line">			<span class="comment">// if we get here, then the user function either exited after being done (finite source)</span></div><div class="line">			<span class="comment">// or the function was canceled or stopped. For the finite source case, we should emit</span></div><div class="line">			<span class="comment">// a final watermark that indicates that we reached the end of event-time</span></div><div class="line">			<span class="built_in">if</span> (!isCanceledOrStopped()) &#123;</div><div class="line">				ctx.emitWatermark(Watermark.MAX_WATERMARK);</div><div class="line">			&#125;</div><div class="line">		&#125; finally &#123;</div><div class="line">			<span class="comment">// make sure that the context is closed in any case</span></div><div class="line">			ctx.<span class="built_in">close</span>();</div><div class="line">		&#125;</div></pre></td></tr></table></figure>
<p><code>StreamSource</code>通过一个属性：<code>canceledOrStopped</code>来控制<code>sourceFunction</code>的停止。</p>
<p>整个<code>StreamSource</code>的运行逻辑由<code>run</code>来表述，通过<code>cancel</code>来控制停止逻辑。</p>
<h3 id="NonTimestampContext"><a href="#NonTimestampContext" class="headerlink" title="NonTimestampContext"></a>NonTimestampContext</h3><p><code>NonTimestampContext</code>会忽略时间戳，因此它的实现里稍微特别一点的地方在下面的这两个方法：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">collectWithTimestamp</span><span class="params">(T element, <span class="keyword">long</span> timestamp)</span> </span>&#123;</div><div class="line">	<span class="comment">// ignore the timestamp</span></div><div class="line">	collect(element);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>以及</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">emitWatermark</span><span class="params">(Watermark mark)</span> </span>&#123;</div><div class="line">	owner.checkAsyncException();</div><div class="line">	<span class="comment">// do nothing else</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>第一个方法忽略了时间戳，第二个方法不发送<code>watermark</code>。</p>
<h3 id="ManualWatermarkContext"><a href="#ManualWatermarkContext" class="headerlink" title="ManualWatermarkContext"></a>ManualWatermarkContext</h3><p>无需特别说明</p>
<h3 id="AutomaticWatermarkContext"><a href="#AutomaticWatermarkContext" class="headerlink" title="AutomaticWatermarkContext"></a>AutomaticWatermarkContext</h3><p>该类是自动发送<code>watermark</code>的实现，在构造器中接收参数<code>watermarkInterval</code>来指定自动发送<code>watermark</code>的时间间隔。具体的实现机制是，新建一个独立的发射线程，以指定的时间间隔发射：</p>
<figure class="highlight aspectj"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">this</span>.scheduleExecutor = Executors.newScheduledThreadPool(<span class="number">1</span>);</div><div class="line"></div><div class="line"><span class="keyword">this</span>.watermarkTimer = scheduleExecutor.scheduleAtFixedRate(<span class="keyword">new</span> Runnable() &#123;</div><div class="line">	<span class="meta">@Override</span></div><div class="line">	<span class="keyword">public</span> <span class="function"><span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</div><div class="line">		<span class="keyword">final</span> <span class="keyword">long</span> currentTime = System.currentTimeMillis();</div><div class="line">		</div><div class="line">		<span class="keyword">if</span> (currentTime &gt; nextWatermarkTime) &#123;</div><div class="line">			<span class="comment">// align the watermarks across all machines. this will ensure that we</span></div><div class="line">			<span class="comment">// don't have watermarks that creep along at different intervals because</span></div><div class="line">			<span class="comment">// the machine clocks are out of sync</span></div><div class="line">			<span class="keyword">final</span> <span class="keyword">long</span> watermarkTime = currentTime - (currentTime % watermarkInterval);</div><div class="line">			</div><div class="line">			<span class="keyword">synchronized</span> (lockingObjectParam) &#123;</div><div class="line">				<span class="keyword">if</span> (currentTime &gt; nextWatermarkTime) &#123;</div><div class="line">					outputParam.emitWatermark(<span class="keyword">new</span> Watermark(watermarkTime));</div><div class="line">					nextWatermarkTime += watermarkInterval;</div><div class="line">				&#125;</div><div class="line">			&#125;</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">&#125;, <span class="number">0</span>, watermarkInterval, TimeUnit.MILLISECONDS);</div></pre></td></tr></table></figure>
<p>除了这种基于时间的以固定频率发射<code>watermark</code>的机制，在collect方法被调用时，也会检查当前的时间戳，如果达到发送条件也会触发<code>emit watermark</code>。</p>
<p>而因为该类实现的是<strong>自动发送</strong>，在构造器中实现一个定时发送机制，所以<code>emitWatermark</code>方法也就不需要再实现发送逻辑（因为已不再需要用户程序调用<code>emitWatermark</code>方法了），而该方法在该类中的主要任务是负责<strong>停止</strong>自动发送。停止自动发送的触发条件是收到最后一个元素的信号（将最后一个元素的时间戳设置为<code>Long.MAX_VALUE</code>），<code>emitWatermark</code>收到该标识后，再将其往下游传递并关闭定时发送线程。</p>
<h2 id="OneInputStreamOperator"><a href="#OneInputStreamOperator" class="headerlink" title="OneInputStreamOperator"></a>OneInputStreamOperator</h2><p>单一输入流的<code>operator</code>接口，继承自<code>StreamOperator</code>。提供了两个接口方法：</p>
<ul>
<li>processElement：处理到达该<code>operator</code>的一个元素</li>
<li>processWatermark：处理一个<code>Watermark</code></li>
</ul>
<h2 id="TwoInputStreamOperator"><a href="#TwoInputStreamOperator" class="headerlink" title="TwoInputStreamOperator"></a>TwoInputStreamOperator</h2><p>支持两个流作为输入的<code>operator</code>，同样继承自<code>StreamOperator</code>。扩充了多个接口方法：</p>
<ul>
<li>processElement1 ： 处理来自第一个输入的某个元素</li>
<li>processElement2 ： 处理来自第二个输入的某个元素</li>
<li>processWatermark1 ： 处理来自第一个输入的一个<code>Watermark</code></li>
<li>processWatermark2 ： 处理来自第二个输入的一个<code>Watermark</code></li>
</ul>
<h2 id="辅助实现类"><a href="#辅助实现类" class="headerlink" title="辅助实现类"></a>辅助实现类</h2><h3 id="Output"><a href="#Output" class="headerlink" title="Output"></a>Output</h3><p><code>Collector</code>的扩展，增加了发射<code>WaterMark</code>的功能。该接口主要供<code>operator</code>用于发射元素或者<code>WaterMark</code>。</p>
<ul>
<li>emitWatermark ： 该发射<code>WaterMark</code>将广播给下游的所有<code>operator</code></li>
</ul>
<h3 id="TimeCharacteristic"><a href="#TimeCharacteristic" class="headerlink" title="TimeCharacteristic"></a>TimeCharacteristic</h3><p>Flink在涉及到时间相关的处理时，将时间划分为三类。而时间类型的定义在Flink中就是用该枚举来表示：</p>
<ul>
<li>ProcessingTime</li>
<li>IngestionTime</li>
<li>EventTime</li>
</ul>
<blockquote>
<p>这三种时间类型之前我们曾多次提及，这里不再啰嗦</p>
</blockquote>
<h3 id="TimestampedCollector"><a href="#TimestampedCollector" class="headerlink" title="TimestampedCollector"></a>TimestampedCollector</h3><p><code>Output</code>的包装器实现，它用于给元素设置时间戳</p>
<h3 id="AbstractStreamOperator"><a href="#AbstractStreamOperator" class="headerlink" title="AbstractStreamOperator"></a>AbstractStreamOperator</h3><p>该抽象类为实现一个具体的<code>operator</code>提供基本的支持，Flink内置提供的<code>operator</code>全部都直接或间接继承自<code>AbstractStreamOperator</code>。</p>
<p>它内部包含了三大类的属性：</p>
<ul>
<li>配置属性</li>
<li>运行时属性</li>
<li>键值对状态属性</li>
</ul>
<p>大都数方法都是辅助方法，值得一提的是<code>setup</code>方法。从这里我们可以看到所有<code>operator</code>标识符的生成方式：</p>
<figure class="highlight arduino"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">String</span> operatorIdentifier = getClass().getSimpleName() + <span class="string">"_"</span> + <span class="built_in">config</span>.getVertexID() + <span class="string">"_"</span> + runtimeContext.getIndexOfThisSubtask();</div></pre></td></tr></table></figure>
<p>可以看到标识是由”_”间隔的三段拼接而成。三段分别是：类名，<code>vertex id</code>，以及当前<code>subtask</code>的索引。</p>
<p>然后基于此标识，创建了用于存储状态的<code>stateBackend</code>：</p>
<figure class="highlight pf"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">state</span>Backend = container.createStateBackend(operatorIdentifier, keySerializer);</div></pre></td></tr></table></figure>
<p><code>stateBackend</code> 在 <code>dispose</code>方法中会被关闭。</p>
<blockquote>
<p><code>AbstractStreamOperator</code>并没有对open/close等生命周期方法提供具体的实现，这些方法的具体实现被后延至后面谈到的<code>AbstractUdfStreamOperator</code>中。</p>
</blockquote>
<h3 id="AbstractUdfStreamOperator"><a href="#AbstractUdfStreamOperator" class="headerlink" title="AbstractUdfStreamOperator"></a>AbstractUdfStreamOperator</h3><p>该类主要针对<code>operator</code>生命周期相关的方法(open/close/dispose)提供了模板实现。而这些实现都统一针对用户定义的<code>Function</code>的实例（简称<code>udf</code>）。</p>
<h3 id="ChainingStrategy"><a href="#ChainingStrategy" class="headerlink" title="ChainingStrategy"></a>ChainingStrategy</h3><p>该枚举定义了<code>operator</code>的<code>chain strategy</code>(链接策略)。当一个<code>operator</code>链接到其前置<code>operator</code>时，意味着它们将在同一个线程上执行。<code>StreamOperator</code>的默认值是<code>HEAD</code>，这意味着它将没有前置<code>operator</code>，不过它有可能成为其他<code>operator</code>的前置<code>operator</code>。大部分<code>StreamOperator</code>将该枚举以<code>ALWAYS</code>覆盖，表示它们将链接到一个前置<code>operator</code>。</p>
<p>它的三个枚举值：</p>
<ul>
<li>ALWAYS ：上面已经提到过，它允许将当前<code>operator</code>链接到某前置<code>operator</code>，这是提升性能的<strong>良好实践</strong>，它能够提升<code>operator</code>的并行度</li>
<li>NEVER ：该策略不支持<code>operator</code>被链接到某前置<code>operator</code>也不支持被作为其他<code>operator</code>的前置<code>operator</code>。</li>
<li>HEAD ：该策略表示<code>operator</code>没有前置<code>operator</code>，不过可以作为其他<code>operator</code>的<code>chain header</code></li>
</ul>
<h2 id="内置的Operator实现"><a href="#内置的Operator实现" class="headerlink" title="内置的Operator实现"></a>内置的Operator实现</h2><h3 id="StreamCounter"><a href="#StreamCounter" class="headerlink" title="StreamCounter"></a>StreamCounter</h3><p>元素累加器，没有什么特别的</p>
<h3 id="StreamProject"><a href="#StreamProject" class="headerlink" title="StreamProject"></a>StreamProject</h3><p>这里需要解释一下，此处的<strong>project</strong>，并非通常所指的项目的意思，而是<code>投射、投影</code>的意思。你可以将其类比于SQL中的<code>SELECT</code>子句。因此他允许你选择你需要的<code>fields</code>集合。这通过其构造器的一个字段索引数组来指定：</p>
<p>在<code>processElement</code>方法中，它依次遍历所有需要的字段索引，将元素中需要的字段提取出来，放入一个用于输出的<code>outTuple</code>，最后再将其发射出去：</p>
<figure class="highlight aspectj"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">void</span> <span class="title">processElement</span><span class="params">(StreamRecord&lt;IN&gt; element)</span> <span class="keyword">throws</span> Exception </span>&#123;</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="keyword">this</span>.numFields; i++) &#123;</div><div class="line">		outTuple.setField(((Tuple) element.getValue()).getField(fields[i]), i);</div><div class="line">	&#125;</div><div class="line">	output.collect(element.replace(outTuple));</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="StreamFilter"><a href="#StreamFilter" class="headerlink" title="StreamFilter"></a>StreamFilter</h3><p><code>filter operator</code>，处理逻辑很简单，根据自定义的<code>FilterFunction</code>方法，对每个元素进行过滤，如果满足过滤条件，则将该元素<code>emit</code>出去。</p>
<h3 id="StreamMap"><a href="#StreamMap" class="headerlink" title="StreamMap"></a>StreamMap</h3><p><code>map operator</code>，根据传入的<code>MapFunction</code>，对每个元素应用<code>map</code>操作后将其发射出去。</p>
<h3 id="StreamFlatMap"><a href="#StreamFlatMap" class="headerlink" title="StreamFlatMap"></a>StreamFlatMap</h3><p><code>flatmap operator</code>接收<code>FlatMapFunction</code>函数，有一些特别之处：在其<code>open</code>方法中，它初始化了一个<code>TimestampedCollector</code>，作为传递给<code>FlatMapFunction</code>的<code>collector</code>，该<code>collector</code>是给那些特定的<code>userFunction</code>使用的，并且用于给他们操作的元素设置时间戳。</p>
<h3 id="StreamGroupedFold"><a href="#StreamGroupedFold" class="headerlink" title="StreamGroupedFold"></a>StreamGroupedFold</h3><p>分组的<code>fold operator</code>，<code>fold</code>函数的执行依赖于一个初始化值<code>initialValue</code>。因此这里涉及到<strong>状态保存</strong>。并且状态是跟具体的分区关联的。因此，在<code>open</code>方法的实现中，需要获得跟分区关联的<code>ValueState</code>：</p>
<figure class="highlight pf"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">ValueStateDescriptor<span class="variable">&lt;OUT&gt;</span> <span class="keyword">state</span>Id = new ValueStateDescriptor<span class="variable">&lt;&gt;</span>(STATE_NAME, <span class="keyword">out</span>TypeSerializer, null);</div><div class="line">values = getPartitionedState(<span class="keyword">state</span>Id);</div></pre></td></tr></table></figure>
<p><code>processElement</code>方法的实现，涉及到一系列的操作：从<code>ValueState</code>中获取数据，作为“新”的<strong>初始值</strong>跟当前元素一起进行<code>fold</code>函数运算，获得结果后更新<code>ValueState</code>，然后将获得的结果<code>emit</code>出去。</p>
<h3 id="StreamGroupedReduce"><a href="#StreamGroupedReduce" class="headerlink" title="StreamGroupedReduce"></a>StreamGroupedReduce</h3><p>按分组进行<code>reduce</code>操作的<code>operator</code>.</p>
<p>基于特定的状态名称：</p>
<figure class="highlight processing"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">String</span> STATE_NAME = <span class="string">"_op_state"</span>;</div></pre></td></tr></table></figure>
<p>构建状态id</p>
<figure class="highlight pf"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ValueStateDescriptor<span class="variable">&lt;IN&gt;</span> <span class="keyword">state</span>Id = new ValueStateDescriptor<span class="variable">&lt;&gt;</span>(STATE_NAME, serializer, null);</div></pre></td></tr></table></figure>
<p>然后再获取状态值：</p>
<figure class="highlight pf"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">values = getPartitionedState(<span class="keyword">state</span>Id);</div></pre></td></tr></table></figure>
<p>以上两个动作在<code>open</code>方法中实现</p>
<p>在<code>processElement</code>方法中，分为两种情况：</p>
<ul>
<li>如果之前已存在状态值，那么拿当前值跟之前的状态值做<code>reduce</code>并获得结果，将结果再次更新到最新状态并<code>emit</code>出去</li>
<li>如果之前不存在状态值，那么直接将当前值更新到状态中，并将当前值<code>emit</code>出去</li>
</ul>
<h3 id="StreamSink"><a href="#StreamSink" class="headerlink" title="StreamSink"></a>StreamSink</h3><p><code>sink operator</code>，通常是流处理的最后一个<code>operator</code>。它接收<code>SinkFunction</code>的实例。在<code>processElement</code>中依次调用其<code>invoke</code>方法。</p>
<h1 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h1><p>本文主要探讨了stream <code>transformation</code>的运行时形式<code>operator</code>的大致实现。</p>
<hr>
<blockquote>
<p>微信扫码关注公众号：Apache_Flink</p>
</blockquote>
<p><img src="http://7xkaaz.com1.z0.glb.clouddn.com/Apache_Flink_weixin.jpg" alt="apache_flink_weichat"></p>
<hr>
<blockquote>
<p>QQ扫码关注QQ群：Apache Flink学习交流群（123414680）</p>
</blockquote>
<p><img src="http://7xkaaz.com1.z0.glb.clouddn.com/qrcode_for_apache_flink_qq_group.png" alt="qrcode_for_apache_flink_qq_group"></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://vinoyang.com/2016/05/21/flink-stream-operator/" data-id="ciybcwckq001o9nvuq1zfhogi" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Flink/">Flink</a></li></ul>

    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2016/05/22/flink-data-streaming-fault-tolerancer/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          Apache Flink数据流的Fault Tolerance机制
        
      </div>
    </a>
  
  
    <a href="/2016/05/14/flink-stream-transformation/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">Apache Flink源码解析之stream-transformation</div>
    </a>
  
</nav>

  
</article>


  <section id="comments">
    <!-- 多说评论框 start -->
    <div class="ds-thread" data-thread-key="post-flink-stream-operator" data-title="Apache Flink源码解析之stream-operator" data-url="http://vinoyang.com/2016/05/21/flink-stream-operator/"></div>
    <!-- 多说评论框 end -->
    <!-- 多说公共JS代码 start (一个网页只需插入一次) -->
    <script type="text/javascript">
    var duoshuoQuery = {short_name:'vinoyang'};
      (function() {
        var ds = document.createElement('script');
        ds.type = 'text/javascript';ds.async = true;
        ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
        ds.charset = 'UTF-8';
        (document.getElementsByTagName('head')[0] 
         || document.getElementsByTagName('body')[0]).appendChild(ds);
      })();
      </script>
    <!-- 多说公共JS代码 end -->
  </section>
</section>
        
          <aside id="sidebar">
  
    
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/Akka/">Akka</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Flink/">Flink</a><span class="tag-list-count">39</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/RabbitMQ/">RabbitMQ</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Zookeeper/">Zookeeper</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/async/">async</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/disque/">disque</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/docker/">docker</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/flume/">flume</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/messagebus/">messagebus</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/morphline/">morphline</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/quartz/">quartz</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/rate-limit/">rate-limit</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/redis/">redis</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/分布式/">分布式</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/分布式锁/">分布式锁</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/日志系统/">日志系统</a><span class="tag-list-count">5</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/消息总线/">消息总线</a><span class="tag-list-count">3</span></li></ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/Akka/" style="font-size: 10px;">Akka</a> <a href="/tags/Flink/" style="font-size: 20px;">Flink</a> <a href="/tags/RabbitMQ/" style="font-size: 10px;">RabbitMQ</a> <a href="/tags/Zookeeper/" style="font-size: 12.5px;">Zookeeper</a> <a href="/tags/async/" style="font-size: 10px;">async</a> <a href="/tags/disque/" style="font-size: 10px;">disque</a> <a href="/tags/docker/" style="font-size: 10px;">docker</a> <a href="/tags/flume/" style="font-size: 15px;">flume</a> <a href="/tags/messagebus/" style="font-size: 10px;">messagebus</a> <a href="/tags/morphline/" style="font-size: 10px;">morphline</a> <a href="/tags/quartz/" style="font-size: 10px;">quartz</a> <a href="/tags/rate-limit/" style="font-size: 10px;">rate-limit</a> <a href="/tags/redis/" style="font-size: 15px;">redis</a> <a href="/tags/分布式/" style="font-size: 10px;">分布式</a> <a href="/tags/分布式锁/" style="font-size: 10px;">分布式锁</a> <a href="/tags/日志系统/" style="font-size: 17.5px;">日志系统</a> <a href="/tags/消息总线/" style="font-size: 15px;">消息总线</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/01/">一月 2017</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/12/">十二月 2016</a><span class="archive-list-count">7</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/11/">十一月 2016</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/10/">十月 2016</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/09/">九月 2016</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/07/">七月 2016</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/06/">六月 2016</a><span class="archive-list-count">6</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/05/">五月 2016</a><span class="archive-list-count">10</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/04/">四月 2016</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/03/">三月 2016</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/02/">二月 2016</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/12/">十二月 2015</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/11/">十一月 2015</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/10/">十月 2015</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/08/">八月 2015</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/07/">七月 2015</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/06/">六月 2015</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/05/">五月 2015</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/04/">四月 2015</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/03/">三月 2015</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/02/">二月 2015</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/01/">一月 2015</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/12/">十二月 2014</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/10/">十月 2014</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/09/">九月 2014</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/06/">六月 2014</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/04/">四月 2014</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/03/">三月 2014</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/02/">二月 2014</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2013/12/">十二月 2013</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2013/10/">十月 2013</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2013/09/">九月 2013</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2013/07/">七月 2013</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2013/05/">五月 2013</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2013/03/">三月 2013</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2013/02/">二月 2013</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2013/01/">一月 2013</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2012/12/">十二月 2012</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2012/11/">十一月 2012</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2012/09/">九月 2012</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2012/08/">八月 2012</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2012/06/">六月 2012</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2012/05/">五月 2012</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2012/04/">四月 2012</a><span class="archive-list-count">6</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2012/03/">三月 2012</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2012/02/">二月 2012</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2012/01/">一月 2012</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2011/12/">十二月 2011</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2011/11/">十一月 2011</a><span class="archive-list-count">6</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2011/10/">十月 2011</a><span class="archive-list-count">9</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2011/09/">九月 2011</a><span class="archive-list-count">8</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2011/08/">八月 2011</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2011/07/">七月 2011</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2011/06/">六月 2011</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2011/05/">五月 2011</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2011/03/">三月 2011</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2011/02/">二月 2011</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2010/07/">七月 2010</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2010/06/">六月 2010</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2010/05/">五月 2010</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2010/04/">四月 2010</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2010/03/">三月 2010</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2010/02/">二月 2010</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2010/01/">一月 2010</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2009/10/">十月 2009</a><span class="archive-list-count">4</span></li></ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recents</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2017/01/24/flink-runtime-taskmanager-run-task/">Flink运行时之TaskManager执行Task</a>
          </li>
        
          <li>
            <a href="/2017/01/15/flink-runtime-netty-part-3/">Flink运行时之基于Netty的网络通信(下)</a>
          </li>
        
          <li>
            <a href="/2017/01/12/flink-runtime-netty-part-2/">Flink运行时之基于Netty的网络通信中</a>
          </li>
        
          <li>
            <a href="/2017/01/08/flink-runtime-netty-part-1/">Flink运行时之基于Netty的网络通信上</a>
          </li>
        
          <li>
            <a href="/2017/01/04/flink-runtime-consumer-input-gate/">Flink运行时之结果分区消费端</a>
          </li>
        
      </ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Weibo show</h3>
    <div class="widget-weibo">
      <iframe width="100%" height="450" class="share_self"  frameborder="0" scrolling="no" src="http://widget.weibo.com/weiboshow/index.php?language=&width=0&height=550&fansRow=2&ptype=1&speed=0&skin=2&isTitle=0&noborder=0&isWeibo=1&isFans=0&uid=1958166695&verifier=9c2d28b9&colors=dddddd,dddddd,666666,0069a4,dddddd&dpc=1"></iframe>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Github</h3>
    <div class="widget-github">
      <script data-name="yanghua" src="http://octocard.in/o.js"></script>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2017 yanghua1127@gmail.com<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
    <a href="/projects" class="mobile-nav-link">Projects</a>
  
    <a href="/about" class="mobile-nav-link">About</a>
  
</nav>
    

<script src="http://apps.bdimg.com/libs/jquery/2.0.3/jquery.min.js"></script>
<script type="text/javascript">
//<![CDATA[
if (typeof jQuery == 'undefined') {
  document.write(unescape("%3Cscript src='/js/jquery-2.0.3.min.js' type='text/javascript'%3E%3C/script%3E"));
}
// ]]>
</script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>

<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "//hm.baidu.com/hm.js?36c1573c11e45ea0f6419af5f2f04760";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>
  </div>
</body>
</html>