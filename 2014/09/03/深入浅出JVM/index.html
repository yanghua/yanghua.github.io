<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="google-site-verification" content="6q22x_DFglYGJjD5t1d95nBYd_U8cDU04B-Haky8KHs" />
  <meta name="baidu-site-verification" content="yEdVDDBr1C" />
  
  <title>深入浅出JVM | yanghua</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="原文地址：http://blog.jamesdbloom.com/JVMInternals.html（转载请注明英文原文出处以及本文地址）这篇文章简要解析了JVM的内部结构。下面这幅图展示了一个典型的JVM（符合JVM Specification Java SE 7 Edition）所具备的关键内部组件。">
<meta property="og:type" content="article">
<meta property="og:title" content="深入浅出JVM">
<meta property="og:url" content="http://vinoyang.com/2014/09/03/深入浅出JVM/index.html">
<meta property="og:site_name" content="yanghua">
<meta property="og:description" content="原文地址：http://blog.jamesdbloom.com/JVMInternals.html（转载请注明英文原文出处以及本文地址）这篇文章简要解析了JVM的内部结构。下面这幅图展示了一个典型的JVM（符合JVM Specification Java SE 7 Edition）所具备的关键内部组件。">
<meta property="og:image" content="http://img.blog.csdn.net/20140903134211841?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQveWFuZ2h1YV9rb2Jl/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast">
<meta property="og:image" content="http://img.blog.csdn.net/20140903144841814?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQveWFuZ2h1YV9rb2Jl/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast">
<meta property="og:image" content="http://img.blog.csdn.net/20140903144943964?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQveWFuZ2h1YV9rb2Jl/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast">
<meta property="og:image" content="http://img.blog.csdn.net/20140903145724336?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQveWFuZ2h1YV9rb2Jl/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast">
<meta property="og:updated_time" content="2015-11-27T05:26:27.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="深入浅出JVM">
<meta name="twitter:description" content="原文地址：http://blog.jamesdbloom.com/JVMInternals.html（转载请注明英文原文出处以及本文地址）这篇文章简要解析了JVM的内部结构。下面这幅图展示了一个典型的JVM（符合JVM Specification Java SE 7 Edition）所具备的关键内部组件。">
  
    <link rel="alternative" href="/atom.xml" title="yanghua" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  <!-- <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css"> -->
  <link rel="stylesheet" href="/css/style.css" type="text/css">
  

</head>
<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">yanghua</a>
      </h1>
      
        <h2 id="subtitle-wrap">
          <a href="/" id="subtitle">alone coder</a>
        </h2>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
          <a class="main-nav-link" href="/projects">Projects</a>
        
          <a class="main-nav-link" href="/about">About</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-github-link" class="nav-icon" href="https://github.com/yanghua" target="_blank" title="GitHub"></a>
        
        
          <a id="nav-weibo-link" class="nav-icon" href="http://weibo.com/yanghua1127" target="_blank" title="Sina Weibo"></a>
        
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" results="0" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://vinoyang.com"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main"><article id="post-深入浅出JVM" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2014/09/03/深入浅出JVM/" class="article-date">
  <time datetime="2014-09-03T15:06:00.000Z" itemprop="datePublished">2014-09-03</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      深入浅出JVM
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <!-- Table of Contents -->
        
        <div><br><br>原文地址：<a href="http://blog.jamesdbloom.com/JVMInternals.html（转载请注明英文原文出处以及本文地址）" target="_blank" rel="external">http://blog.jamesdbloom.com/JVMInternals.html（转载请注明英文原文出处以及本文地址）</a><br><br>这篇文章简要解析了JVM的内部结构。下面这幅图展示了一个典型的JVM（符合JVM Specification Java SE 7 Edition）所具备的关键内部组件。<br><br><a id="more"></a><br><br><img src="http://img.blog.csdn.net/20140903134211841?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQveWFuZ2h1YV9rb2Jl/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt=""><br><br>上图展示的所有这些组件都将在下面两个章节中被解析。第一章包含将会在每个线程上创建的组件；第二章包含那些不依赖于线程即可创建的组件（线程间可共享的组件）。<br><br><em>   线程内创建

</em>   JVM系统线程<br><em>   单个线程
</em>   程序计数器（PC）<br><em>   栈
</em>   原生栈<br><em>   栈的限制
</em>   Frame<br><em>   局部变量数组
</em>   操作数栈<br><em>   动态链接</em>   线程之间共享<br><br># 线程内组件<br><br>一个线程是对程序的一次执行。JVM允许一个应用创建多个线程并行地执行。在HotspotJVM中，对Java线程和原生操作系统线程之间有一个直接的映射。在所有用于创建Java线程的状态（诸如：thread-local存储、分配缓冲区、同步对象、栈以及程序计数器）准备好之后，原生线程才会被创建。而一旦Java线程终止，原生线程将会被回收。因此，操作系统将会调度所有线程并分配给它们任何可用的CPU时间片。一旦原生线程被实例化完成，它将调用Java线程上的run()方法。当run()方法返回，未捕获的异常被处理，原生线程会确认JVM是否需要随着线程的终止而终止（比如它是最后一个非deamon线程）。一旦线程被终止，无论是原生线程还是Java线程，它们所占用的资源都会被释放。<br><br>## JVM系统线程<br><br>如果你用jconsole或者任何其他的debug工具查看，可能会看到有许多线程在后台运行。这些运行着的后台线程不包含主线程，主线程是基于执行publicstatic void main(String[]) 的需要而被创建的。而这些后台线程都是被主线程所创建。在HotspotJVM中主要的后台系统线程，见下表：<br><br><table border="1" width="650" cellspacing="0" cellpadding="0"><tbody><tr><td>VM 线程</td><td>该线程用于等待执行一系列能够使得JVM到达一个“safe-point”的操作。<br>而这些操作不得不发生在一个独立的线程上的原因是：它们都要求JVM处于一个——无法修改堆的safepoint。<br>被这个线程执行的该类操作都是“stop-the-world”型的垃圾回收、线程栈回收、线程搁置以及有偏差的锁定撤销。</td></tr><tr><td>周期性的任务线程</td><td>该线程用于响应timer事件（例如，中断），这些事件用于调度执行周期性的操作</td></tr><tr><td>GC 线程</td><td>这些线程支持在JVM中不同类型的垃圾回收</td></tr><tr><td>编译器线程</td><td>它们用于在运行时将字节码编译为本地机器码</td></tr><tr><td>信号分发线程</td><td>该线程接收发送给JVM的信号，并通过调用JVM合适的方法进行处理</td></tr></tbody></table><br><br>## 单个线程<br><br>每个线程的一次执行都包含如下的组件<br><br>## 程序计数器（PC）<br><br>除非当前指令或者操作码是原生的，否则当前指令或操作码的地址都需要依赖于PC来寻址。如果当前方法是原生的，那么该PC即为undefined。所有的CPU都有一个PC，通常PC在每个指令执行后被增加以指向即将执行的下一条指令的地址。JVM使用PC来跟踪正在执行的指令的位置。事实上，PC被用来指向methodarea的一个内存地址。<br><br>## 栈<br><br>每个线程都有属于它自己的栈，用于存储在线程上执行的每个方法的frame。栈是一个后进先出的数据结构，这可以使得当前正在执行的方法位于栈的顶部。对于每个方法的执行，都会有一个新的frame被创建并被入栈到栈的顶部。当方法正常的返回或在方法执行的过程中遇到未捕获的异常时frame会被出栈。栈不会被直接进行操作，除了push/ pop frame 对象。因此可以看出，frame对象可能会被分配在堆上，并且内存也没必要是连续的地址空间（请注意区分frame的指针跟frame对象）。<br><br>## 原生栈<br><br>不是所有的JVM都支持原生方法，但那些支持该特性的JVM通常会对每个线程创建一个原生方法栈。如果对JVM的JNI（JavaNative Invocation）采用c链接模型的实现，那么原生栈也将是一个C实现的栈。在这个例子中，原生栈中参数的顺序 、返回值都将跟通常的C程序相同。一个原生方法通常会对JVM产生一个回调（这依赖于JVM的实现）并执行一个Java方法。这样一个原生到Java的调用发生在栈上（通常在Java栈），与此同时线程也将离开原生栈，通常在Java栈上创建一个新的frame。<br><br>## 栈的限制<br><br>一个栈可以是动态的或者是有合适大小的。如果一个线程要求更大的栈，那么将抛出StackOverflowError异常；如果一个线程要求新创建一个frame，又没有足够的内存空间来分配，将会抛出OutOfMemoryError异常。<br><br>## Frame<br><br>对于每一个方法的执行，一个新frame会被创建并被入栈到栈顶。当方法正常返回或在方法执行的过程中遇到未捕获的异常，frame会被出栈。<br><br>每个frame都包含如下部分：<br><br><em>   局部变量数组

</em>   返回值<br><em>   操作数栈
</em>   对当前方法所属的类的常量池的引用<br><br>## 局部变量数组<br><div><br><br>局部变量数组包含了在方法执行期间所用到的所有的变量。包含一个对this的引用，所有的方法参数，以及其他局部定义的变量。对于类方法（比如静态方法），方法参数的存储索引从0开始；而对于实例方法，索引为0的槽都为存储this指针而保留。<br><br>一个局部变量，可以是如下类型：<br><br><em>   boolean
</em>   byte<br><em>   char
</em>   long<br><em>   short
</em>   int<br><em>   float
</em>   double<br><em>   reference
</em>   returnAddress<div>除了long以及double(它们都占据两个连续的槽，因为它们有双倍的宽度为64位，而不是32位)其他所有的类型都在局部变量数组中占据一个独立的槽位。<br></div>

<h2 id="操作数栈">操作数栈</h2><div>操作数栈在字节码指令被执行的过程中使用。它跟原生CPU使用的通用目的的寄存器类似。大部分的字节码都把时间花费在跟操作数栈打交道上，通过入栈、出栈、复制、交换或者执行那些生产/消费值的操作。对字节码而言，那些在局部变量数组和操作数栈之间移动值的指令是非常频繁的。例如，一个简单的变量初始化，就导致产生两个与操作数栈交互的字节码。<br></div><div><pre name="code" class="java">int i;</pre><br>编译后获得如下的字节码：<br></div><div><pre code_snippet_id="673917" snippet_file_name="blog_20150524_2_7571773" name="code" class="java">0:iconst_0// Push 0 to top of the operand stack<br>1:istore_1// Pop value from top of operand stack and store as local variable 1</pre>对更多细节，请阅读后续内容。<br><br>## 动态链接<br></div><div>每个frame都包含一个对运行时常量池的引用。该引用指向将要被执行的方法所属的类的常量池。该引用也用于辅助动态链接。<br></div><div>C/C++ 代码通常被编译为一个对象文件，然后多个对象文件被链接到一起从而产生一个可用的artifact，例如一个可执行文件或dll。在链接阶段，每个对象文件内的符号引用被替代为一个跟最终可执行文件相关的实际内存地址。而对于Java而言，这个链接阶段将会在运行时被动态的完成。<br></div><div>当一个Java类被编译时，所有对存储在类的常量池中的变量以及方法的引用都被当做符号引用。一个符号引用仅仅只是一个逻辑引用而不是最终指向物理内存地址的引用。JVM的实现可以选择解析符号引用的时机，该时机可以发生在当类文件被验证后、被加载后，这称之eager或静态分析；不同的是它也可以发生在当符号引用被首次使用的时候，称之为lazy或延迟分析。但JVM必须保证：解析发生在每个引用被首次使用前，同时在该时间点，如果遇到分析错误能够抛出异常。绑定是一个处理过程，它将被符号引用标识的字段、方法或类替换为一个直接引用。这个处理过程只发生一次，因为符号引用需要被完全替换。如果一个符号引用关联着一个类，而该类还没有被解析，那么该类也会被立即加载。每个直接引用都被以偏移的方式存储，该存储结构关联着变量或方法的运行时位置。<br></div>

<h1 id="线程之间共享">线程之间共享</h1><h2 id="堆">堆</h2><div>堆用来在运行时存储类的实例和数组。数组和对象永远不能被分配到栈上，因为frame被设计为在其创建后不可更改大小。Frame只存储用于指向堆中的数组和对象的指针。不像原始类型以及存储在局部变量数组中的引用（以上这些都指存储在每个frame里的），对象总是存储在堆上，所以当一个方法执行结束，它们不会被立即移除（对象只能被垃圾回收器回收）。<br></div><div>为了支持垃圾回收，堆被分隔为三个部分：<br></div><div><br><br><em>   青年代

</em>   通常又被分割为Eden跟Survivor两个部分<em>   老年代（也称之为终身代）
</em>   永久代<br><br>## 内存管理<br></div><div><br><br>对象和数组永远都不会被显式释放，因此只能依靠垃圾回收器来自动地回收它们。<br>通常，以如下的步骤进行：<br></div><div><br><br>1.  新对象和数组被创建在年轻代<br><br>2.  次垃圾回收器将在年轻代上执行。那些仍然存活着的对象，将被从eden区移动到survivor区<br><br>3.  主垃圾回收器将会把对象在代与代之间进行移动，主垃圾回收器通常会导致应用程序的线程暂停。那些仍然存活着的对象将被从年轻代移动到老年代<br><br>4.  永久代会在每次老年代被回收的时候同时进行，它们在两者中其一满了之后都会被回收<br><br>## 非堆式内存<br></div><div>有些对象并不会创建在堆中，这些对象在逻辑上被认为是JVM机制的一部分。<br></div><div>非堆式的内存包括：<br></div><div><br><br><em>   永久代中包含：

</em>   方法区<br><br><em>   内部字符串</em>   代码缓存：用于编译以及存储方法，这些方法已经被JIT编译成本地代码<br><br>## JIT编译<br></div><div>Java 字节码是被解释过的，但它还是没有在JVM所宿主的CPU上执行原生代码快。为了提高性能，OracleHotspot VM会寻找那些有规律地执行的字节码，并把他们编译为本地原生代码。而原生代码将会被存储在代码缓存的非“堆”内存区。这样，HotspotVM会尝试去选择最合适的方式在它编译代码以及它执行被解释过代码的额外时间之间作出权衡。<br></div>

<h2 id="方法区">方法区</h2><div>方法区存储了每个类的信息，例如：<br></div><div><br><br><em>   类加载器的引用

</em>   运行时常量池<br><br><em>   数值常量

</em>   字段引用<br><br><em>   方法引用
</em>   属性<em>   字段数据

</em>   对每个字段<em>   方法数据

</em>   对每个方法*   方法体所有的线程共享相同的方法区。所以，对于方法区数据的访问以及对动态链接的处理必须是线程安全的。如果两个线程企图访问一个还没有被载入的类（该类必须只能被加载一次）的字段或者方法，直到该类被加载完成，这两个线程才能继续执行。<br></div>

<h2 id="类的文件结构">类的文件结构</h2><div>一个被编译过的类文件包含如下的结构：<br></div><div><pre code_snippet_id="673917" snippet_file_name="blog_20150524_3_6115221" name="code" class="plain">ClassFile {<br>    u4magic;<br>    u2minor_version;<br>    u2major_version;<br>    u2constant_pool_count;<br>    cp_infocontant_pool[constant_pool_count – 1];<br>    u2access_flags;<br>    u2this_class;<br>    u2super_class;<br>    u2interfaces_count;<br>    u2interfaces[interfaces_count];<br>    u2fields_count;<br>    field_infofields[fields_count];<br>    u2methods_count;<br>    method_infomethods[methods_count];<br>    u2attributes_count;<br>    attribute_infoattributes[attributes_count];<br>}</pre><br><table border="1" width="700" cellspacing="0" cellpadding="0"><tbody><tr><td>magic,<br>minor_version,<br>major_version</td><td>指定一些信息：<br>当前类的版本、编译当前类的JDK版本</td></tr><tr><td>constant_pool</td><td>跟符号表相似，但它包含更多的数据</td></tr><tr><td>access_flags</td><td>为该类提供一组修改器</td></tr><tr><td>this_class</td><td>为该类提供完全限定名在常量池中的索引，例如：org/jamesdbloom/foo/Bar</td></tr><tr><td>super_class</td><td>提供对其父类的符号引用在常量池中的索引，例如：java/lang/Object</td></tr><tr><td>interface</td><td>常量池中的数组索引，该数组提供对所有被实现的接口的符号引用</td></tr><tr><td>fields</td><td>常量池中的数组索引，该数组提供对每个字段的完整描述</td></tr><tr><td>methods</td><td>常量池中的数组索引，该数组提供对每个方法签名的完整描述，如果该方法不是抽象的或者native的，<br>那么也会包含字节码</td></tr><tr><td>attributes</td><td>不同值的数组，提供关于类的额外信息，包括注解：RetentionPolicy.CLASS以及RetentionPolicy.RUNTIME</td></tr></tbody></table><br></div><div>可以使用javap命令查看被编译后的java类的字节码。<br></div><div>如果你编译下面的简单类：<br></div><div><pre code_snippet_id="673917" snippet_file_name="blog_20150524_8_9275259" name="code" class="java">package org.jvminternals;<br><br>public class SimpleClass {<br><br>    public void sayHello() {<br>        System.out.println(&quot;Hello&quot;);<br>    }<br><br>}</pre><br>如果你运行下面的命令，那么你将看到下面的输出：<br></div><div>javap -v -p -s -sysinfo -constantsclasses/org/jvminternals/SimpleClass.class<br></div><div><pre code_snippet_id="673917" snippet_file_name="blog_20150524_5_561785" name="code" class="plain">public class org.jvminternals.SimpleClass<br>  SourceFile: &quot;SimpleClass.java&quot;<br>  minor version: 0<br>  major version: 51<br>  flags: ACC_PUBLIC, ACC_SUPER<br>Constant pool:<br>   #1 = Methodref          #6.#17         //  java/lang/Object.&quot;&lt;init&gt;&quot;:()V<br>   #2 = Fieldref           #18.#19        //  java/lang/System.out:Ljava/io/PrintStream;<br>   #3 = String             #20            //  &quot;Hello&quot;<br>   #4 = Methodref          #21.#22        //  java/io/PrintStream.println:(Ljava/lang/String;)V<br>   #5 = Class              #23            //  org/jvminternals/SimpleClass<br>   #6 = Class              #24            //  java/lang/Object<br>   #7 = Utf8               &lt;init&gt;<br>   #8 = Utf8               ()V<br>   #9 = Utf8               Code<br>  #10 = Utf8               LineNumberTable<br>  #11 = Utf8               LocalVariableTable<br>  #12 = Utf8               this<br>  #13 = Utf8               Lorg/jvminternals/SimpleClass;<br>  #14 = Utf8               sayHello<br>  #15 = Utf8               SourceFile<br>  #16 = Utf8               SimpleClass.java<br>  #17 = NameAndType        #7:#8          //  &quot;&lt;init&gt;&quot;:()V<br>  #18 = Class              #25            //  java/lang/System<br>  #19 = NameAndType        #26:#27        //  out:Ljava/io/PrintStream;<br>  #20 = Utf8               Hello<br>  #21 = Class              #28            //  java/io/PrintStream<br>  #22 = NameAndType        #29:#30        //  println:(Ljava/lang/String;)V<br>  #23 = Utf8               org/jvminternals/SimpleClass<br>  #24 = Utf8               java/lang/Object<br>  #25 = Utf8               java/lang/System<br>  #26 = Utf8               out<br>  #27 = Utf8               Ljava/io/PrintStream;<br>  #28 = Utf8               java/io/PrintStream<br>  #29 = Utf8               println<br>  #30 = Utf8               (Ljava/lang/String;)V<br>{<br>  public org.jvminternals.SimpleClass();<br>    Signature: ()V<br>    flags: ACC_PUBLIC<br>    Code:<br>      stack=1, locals=1, args_size=1<br>        0: aload_0<br>        1: invokespecial #1    // Method java/lang/Object.&quot;&lt;init&gt;&quot;:()V<br>        4: return<br>      LineNumberTable:<br>        line 3: 0<br>      LocalVariableTable:<br>        Start  Length  Slot  Name   Signature<br>          0      5      0    this   Lorg/jvminternals/SimpleClass;<br><br>  public void sayHello();<br>    Signature: ()V<br>    flags: ACC_PUBLIC<br>    Code:<br>      stack=2, locals=1, args_size=1<br>        0: getstatic      #2    // Field java/lang/System.out:Ljava/io/PrintStream;<br>        3: ldc            #3    // String &quot;Hello&quot;<br>        5: invokevirtual  #4    // Method java/io/PrintStream.println:(Ljava/lang/String;)V<br>        8: return<br>      LineNumberTable:<br>        line 6: 0<br>        line 7: 8<br>      LocalVariableTable:<br>        Start  Length  Slot  Name   Signature<br>          0      9      0    this   Lorg/jvminternals/SimpleClass;<br>}</pre><br>该类文件显示了三个主要部门：常量池、构造器以及sayHello方法<br></div><div><br><br><em>   常量池：它提供了跟通用符号表提供的相同的信息

</em>   方法：（每个都包含四个区域）</div><div>下面列出了在该类文件中，使用到的操作码：<br></div><div><table border="1" width="650" cellspacing="0" cellpadding="0"><tbody><tr><td>aload<em>0</em></td><td>该操作码是形如aload&lt;n&gt;格式的一组操作码中其中的一个。<br>它们都是用来加载一个对象引用到操作数栈。<br>而“&lt;n&gt;”用于指示要被访问的对象引用在局部变量数组中的位置，但n的值只能是0，1，2或3。<br>也有其他相似的操作码用来加载非对象引用，如：iload<em>&lt;n&gt;,lload</em>&lt;n&gt;,fload<em>&lt;n&gt;以及dload</em>&lt;n&gt;<br>（其中，i表示int，l表示long，f表示float，而d表示double，上面n的取值范围对这些*load_&lt;n&gt;同样适用）。<br>局部变量的索引如果大于3，可以使用iload，lload，float，dload和aload加载。<br>这些操作码都携带要被加载的局部变量在数组中的索引。</td></tr><tr><td>ldc</td><td>该操作码用来从运行时常量池取出一个常量压入操作数栈</td></tr><tr><td>getstatic</td><td>该操作码用来从运行时常量池的静态字段列表入栈一个静态值到操作数栈</td></tr><tr><td>invokespecial<br>invokevirtual</td><td>这些操作码是一组用来执行方法的操作码<br>（总共有：invokedynamic、invokeinterface、invokespecial、invokestatic、invokevirtual这几种）。<br>其中，本例中出现的invokevirtual用来执行类的实例方法；<br>而invokespecial用于执行实例的初始化方法，同时也用于执行私有方法以及属于超类但被当前类继承的方法<br>（超类方法动态绑定到子类）。</td></tr><tr><td>return</td><td>该操作码是一组操作码（ireturn,lreturn,freturn,dreturn,areturn以及return）中的其中一个。<br>每个操作码，都是类型相关的返回语句。<br>其中i代表int，l表示long，f表示float，d表示double而a表示一个对象的引用。<br>没有标识符作为首字母的return语句，仅会返回void</td></tr></tbody></table><br></div><div>就像在其他通用的字节码中那样，以上这些操作码主要用于跟本地变量、操作数栈以及运行时常量池打交道。<br></div><div>构造器有两个指令，第一个将“this”压入到操作数栈，接下来该构造器的父构造器被执行，这一操作将导致this被“消费”，因此this将从操作数栈出栈。<br></div><div><img src="http://img.blog.csdn.net/20140903144841814?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQveWFuZ2h1YV9rb2Jl/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt=""><br></div><div><br></div><div><br></div><div>而对于sayHello()方法，它的执行将更为复杂。因为它不得不通过运行时常量池，解析符号引用到真实的引用。第一个操作数getstatic，用来入栈一个指向System类的静态字段out的引用到操作数栈。接下来的操作数ldc，入栈一个字符串字面量“Hello”到操作数栈。最后，invokevirtual操作数，执行System.out的println方法，这将使得“Hello”作为一个参数从操作数栈出栈，并为当前线程创建一个新的frame。<br></div><div><img src="http://img.blog.csdn.net/20140903144943964?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQveWFuZ2h1YV9rb2Jl/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt=""><br></div><div><br></div>

<h2 id="类加载器">类加载器</h2><div>JVM的启动是通过bootstrap类加载器来加载一个用于初始化的类。在publicstatic void main(String[])被执行前，该类会被链接以及实例化。main方法的执行，将顺序经历加载，链接，以及对额外必要的类跟接口的初始化。<br></div></div>

<p><strong>加载</strong>: 加载是这样一个过程：查找表示该类或接口类型的类文件，并把它读到一个字节数组中。接着，这些字节会被解析以确认它们是否表示一个Class对象以及是否有正确的主、次版本号。任何被当做直接superclass的类或接口也一同被加载。一旦这些工作完成，一个类或接口对象将会从二进制表示中创建。</p>
<p><strong>链接</strong>: 链接包含了对该类或接口的验证，准备类型以及该类的直接父类跟父接口。简而言之，链接包含三个步骤：验证、准备以及解析（optional）</p>
<blockquote>
<p><strong>验证: </strong>该阶段会确认类以及接口的表示形式在结构上的正确性，同时满足Java编程语言以及JVM语义上的要求。比如，接下来的检查动作将会被执行：</p>
<ol>
<li><p>一致以及正确被格式化的符号表</p>
</li>
<li><p>final方法或类没有被override</p>
</li>
<li><p>方法必须带有访问控制关键字</p>
</li>
<li><p>方法有正确的参数值跟类型</p>
</li>
<li><p>字节码不会对栈进行不正确得篡改</p>
</li>
<li><p>变量在被读取之前已经进行了初始化</p>
</li>
<li><p>变量具有正确的类型<div>在验证阶段执行这些检查意味着在运行时可以免去在链接阶段进行这些动作，虽然拖慢了类的加载速度，然而它避免了在执行字节码的时候执行这些检查。<br></div><div><strong>准备:</strong> 包含了对静态存储的内存分配以及JVM所使用的任何数据结构（比如方法表）。静态字段都被创建以及实例化为它们的默认值。然而，没有任何实例化器或代码在这个阶段被执行，因为这些任务将会发生在实例化阶段。<br></div><div><strong>解析:</strong> 是一个可选的阶段。该阶段通过加载引用的类或接口来检查符号引用是否正确。如果在这个点这些检查没发生，那么对符号引用的解析会被推迟到直到它们被字节码指令使用之前。<br></div></p>
</li>
</ol>
</blockquote>
<p>实例化 类或接口，包含执行类或接口的实例化方法：&lt;clinit&gt;</p>
<p><img src="http://img.blog.csdn.net/20140903145724336?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQveWFuZ2h1YV9rb2Jl/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt=""></p>
<p>在JVM中存在多个不同职责的类加载器。每一个类加载器都代理其已被加载的父加载器（除了bootstrap类加载器，因为它是根加载器）。</p>
<blockquote>
<p><strong>Bootstrap类加载器</strong>：通常使用原生代码实现，因为它在JVM启动后很快就会被初始化。Bootstrap类加载器用于加载最基本的JavaAPI，比如rt.jar。它仅加载那些位于boot类路径中的信任级别很高的类。因此，它也跳过了很多验证过程。</p>
<p><strong>Extension 类加载器：</strong>从标准的Java扩展API中加载类。例如，安全的扩展功能集。</p>
<p><strong>System 类加载器：</strong>这是应用程序默认的类加载器。它从classpath中加载应用程序类。</p>
<p><strong>用户定义的类加载器：</strong>可以额外得定义类加载器来加载应用程序类。用户定义的类加载器可用于一些特殊的场景，比如：在运行时重新加载类或将一些特殊的类隔离为多个不同的分组（通常web服务器中都会有这样的需求，比如Tomcat）。</p>
</blockquote>
<h2 id="更快的类加载">更快的类加载</h2><p>一个称之为类数据共享（CDS）的特性自HotspotJVM 5.0开始被引进。在安装JVM期间，安装器加载一系列的Java核心类（如rt.jar）到一个经过映射过的内存区进行共享存档。CDS减少了加载这些类的时间从而提升了JVM的启动速度，同时允许这些类在不同的JVM实例之间共享。这大大减少了内存碎片。</p>
<h2 id="方法区的位置">方法区的位置</h2><p>JVM Specification Java SE 7 Edition清楚地声明：尽管方法区是堆的一个逻辑组成部分，但最简单的实现可能是既不对它进行垃圾回收也不压缩它。然而矛盾的是利用jconsole查看Oracle的JVM的方法区（以及CodeCache）是非堆形式的。OpenJDK代码显示CodeCache相对ObjectHeap而言是VM中一个独立的域。</p>
<h2 id="类加载器引用">类加载器引用</h2><p>所有的类都包含一个指向加载它们的类加载器的引用。反过来类加载器也包含它加载的所有类的引用。</p>
<h2 id="运行时常量池">运行时常量池</h2><p>JVM对每个类型维护着一个常量池，它是一个跟符号表相似的运行时数据结构，但它包含了更多的数据。Java的字节码需要一些数据，通常这些数据会因为太大而难以直接存储在字节码中。取而代之的一种做法是将其存储在常量池中，字节码包含一个对常量池的引用。运行时常量池主要用来进行动态链接。</p>
<p>几种类型的数据会存储在常量池中，它们是：</p>
<ul>
<li><p>数值字面量</p>
</li>
<li><p>字符串字面量</p>
</li>
<li><p>类的引用</p>
</li>
<li><p>字段的引用</p>
</li>
<li><p>方法的引用<div>例如下面的示例代码：<br></div><div><pre code_snippet_id="673917" snippet_file_name="blog_20150524_6_5974531" name="code" class="java">Object foo = new Object();</pre><br>编译为字节码将会像如下这样：<br></div><div><pre code_snippet_id="673917" snippet_file_name="blog_20150524_7_6370768" name="code" class="plain"> 0: new #2     // Class java/lang/Object<br>1:dup<br>2:invokespecial #3    // Method java/ lang/Object &quot;&lt;init&gt;&quot;( ) V</pre><br>“new”操作码后面跟着#2操作数。该操作数是一个指向常量池的索引，因此它引用常量池中得第二条记录。而第二条记录是一个类的引用，该记录反过来引用另一个位于常量池里的记录（它是一个用UTF8编码的类名：//Class java/lang/Object）。该符号链接稍后会用于查找java.lang.Object类。new操作码创建类的一个实例同时实例化它的变量。这个指向类的新实例的引用会被加入到操作数栈。dup操作码接着创建一个额外的对操作数栈的栈顶引用的拷贝。同时将this引用加入栈顶。最终，一个实例的初始化方法会被调用（上图第二行通过调用invokespecial）。this操作数同样也包含一个对常量池的引用。实例化方法消费栈顶引用（把其视为传递给该方法的一个参数）。最终，将会产生一个对新对象的引用（这个引用是既被创建完成也被初始化完成的）。<br></div><div>如果你编译下面的这个简单的类：<br></div><div><pre code_snippet_id="673917" snippet_file_name="blog_20150524_8_9275259" name="code" class="java">package org.jvminternals;</pre></div></p>
</li>
</ul>
<p>public class SimpleClass {</p>
<pre><code><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">sayHello</span>(<span class="params"></span>) </span>{
    System.<span class="keyword">out</span>.println(&amp;quot;Hello&amp;quot;);
}
</code></pre><p>}<br>生成的类文件的常量池，看起来会像下图所示：<br></p></div><div><pre code_snippet_id="673917" snippet_file_name="blog_20150524_9_2179752" name="code" class="plain">Constant pool:<p></p>
<p>   #1 = Methodref          #6.#17         //  java/lang/Object.&quot;&lt;init&gt;&quot;:()V</p>
<p>   #2 = Fieldref           #18.#19        //  java/lang/System.out:Ljava/io/PrintStream;</p>
<p>   #3 = String             #20            //  &quot;Hello&quot;</p>
<p>   #4 = Methodref          #21.#22        //  java/io/PrintStream.println:(Ljava/lang/String;)V</p>
<p>   #5 = Class              #23            //  org/jvminternals/SimpleClass</p>
<p>   #6 = Class              #24            //  java/lang/Object</p>
<p>   #7 = Utf8               &lt;init&gt;</p>
<p>   #8 = Utf8               ()V</p>
<p>   #9 = Utf8               Code</p>
<p>  #10 = Utf8               LineNumberTable</p>
<p>  #11 = Utf8               LocalVariableTable</p>
<p>  #12 = Utf8               this</p>
<p>  #13 = Utf8               Lorg/jvminternals/SimpleClass;</p>
<p>  #14 = Utf8               sayHello</p>
<p>  #15 = Utf8               SourceFile</p>
<p>  #16 = Utf8               SimpleClass.java</p>
<p>  #17 = NameAndType        #7:#8          //  &quot;&lt;init&gt;&quot;:()V</p>
<p>  #18 = Class              #25            //  java/lang/System</p>
<p>  #19 = NameAndType        #26:#27        //  out:Ljava/io/PrintStream;</p>
<p>  #20 = Utf8               Hello</p>
<p>  #21 = Class              #28            //  java/io/PrintStream</p>
<p>  #22 = NameAndType        #29:#30        //  println:(Ljava/lang/String;)V</p>
<p>  #23 = Utf8               org/jvminternals/SimpleClass</p>
<p>  #24 = Utf8               java/lang/Object</p>
<p>  #25 = Utf8               java/lang/System</p>
<p>  #26 = Utf8               out</p>
<p>  #27 = Utf8               Ljava/io/PrintStream;</p>
<p>  #28 = Utf8               java/io/PrintStream</p>
<p>  #29 = Utf8               println</p>
<p>  #30 = Utf8               (Ljava/lang/String;)V</p></pre><br>常量池中包含了下面的这些类型：<br></div><div><table border="1" width="650" cellspacing="0" cellpadding="0"><tbody><tr><td>Integer</td><td>一个4字节的int常量</td></tr><tr><td>Long</td><td>一个8字节的long常量</td></tr><tr><td>Float</td><td>一个4字节的float常量</td></tr><tr><td>Double</td><td>一个8字节的double常量</td></tr><tr><td>String</td><td>一个String字面值常量指向常量池中另一个包含最终字节的UTF8记录</td></tr><tr><td>Utf8</td><td>一个字节流表示一个Utf8编码的字串序列</td></tr><tr><td>Class</td><td>一个Class字面值常量指向常量池中的另一个Utf8记录，它包含JVM内部格式的完全限定名<br>（它用于动态链接）</td></tr><tr><td>NameAndType</td><td>用一个冒号区分一对值，每个值都指向常量池中得其他记录。<br>冒号前的第一个值指向一个utf8字符串字面量表示方法名或者字段名。<br>第二个值指向一个utf8字符串字面量表示类型。<br>举一个字段的例子是完全限定的类名；<br>举一个方法的例子是: 它是一个列表，该列表中每个参数都是完全限定的类名</td></tr><tr><td>Fieldref,<br>Methodref,<br>InterfaceMethodref</td><td>用点来分隔的一对值，每个值指向常量池中的另一个记录。<br>点前的第一个值指向一个Class记录。第二个值指向一个NameAndType记录</td></tr></tbody></table><br></div><p></p>
<h2 id="异常表">异常表</h2><div>异常表存储了每个异常处理器的信息：<br></div><div><br><br><em>   起始点

</em>   终止点<br><br><em>   处理代码的PC偏移量

</em>   被捕获的异常类的常量池索引<div>如果一个方法定义了try-catch或try-finally异常处理器，那么一个异常表将会被创建。它包含了每个异常处理器的信息或者finally块以及正在被处理的异常类型跟处理器代码的位置。<br></div></div><div>当一个异常被抛出，JVM会为当前方法寻找一个匹配的处理器。如果没有找到，那么该方法最终会唐突地出栈当前stackframe而异常会被重新抛出到调用链（新的frame）。如果在所有的frame都出栈之前还是没有找到异常处理器，那么当前线程将会被终止。当然这也可能会导致JVM被终止，如果异常被抛出到最后一个非后台线程的话，比如该线程就是主线程。<br></div><div>最终异常处理器会匹配所有的异常类型并且无论什么时候该类型的异常被抛出总是会得到执行。在没有异常抛出的例子中，finally块仍然会在方法的最后被执行。一旦return语句被执行就会立即跳转到finally代码块继续执行。<br></div>

<h2 id="符号表">符号表</h2><div>除了每个类型的运行时常量池，HotspotJVM对每个类型都有一个符号表存储在“永久代”中。符号表是一个hashtable将符号指针映射到符号（比如：Hashtable&lt;Symbol*,Symbol&gt;），另外符号表还包含一个指针指向所有符号（这囊括了每个类的运行时常量池）。<br></div><div>“引用计数”被用来作为控制某个符号要从符号表里删除的机制。例如，当某个类被卸载后，所有它的运行时常量池中的符号的引用计数都会被减一。当符号表中的一个符号的引用计数到达0时，符号表就认为该符号将不会再被引用，而随后也会被从符号表中卸载。无论是符号表还是字符串表（见下面），所有的记录都存储在一个标准化的表单中以此来提升性能同时可以确认每条记录仅仅出现一次。<br></div>

<h2 id="内部字符串（字符串表）">内部字符串（字符串表）</h2><div>Java语言规范要求相同的字符串字面量，包含相同的unicode字符序列的字符串字面量必须关联到相同的String实例。另外，如果String.intern()在一个字符串实例上被调用，那么必须返回一个引用，该引用指代的实例必须跟该字符串的字面量相同。下面的代码将返回true。<br></div><div><pre code_snippet_id="673917" snippet_file_name="blog_20150524_10_416398" name="code" class="java">&quot;j&quot; + &quot;v&quot; + &quot;m&quot;).intern() == &quot;jvm&quot;</pre><br>在JVM中，内部字符串被存储在字符串表中。字符串表是一个hashtable映射对象指针到符号（比如：Hashtable&lt;oop,Symbol&gt;），它被存储在永久代里。<br></div><div>当类被加载时，字符串字面量会被编译器自动“内部化”并且被加入到字符表。另外字符串类的实例可以通过调用String.intern()来明确地内部化。当String.intern()被调用，如果符号表里已经包含该字符串，那么指向该字符串的引用将被返回。如果该字符串没有包含在字符表，则会被加入到字符串表同时返回其引用。<br></div><div><br></div><br>

<!-- Baidu Button BEGIN -->
      
    </div>
    <footer class="article-footer">
      <a data-url="http://vinoyang.com/2014/09/03/深入浅出JVM/" data-id="cikg8jgh2000h2rz2x14weawu" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2014/09/05/ApacheOFbizMiniLang源码解读/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          ApacheOFbizMiniLang源码解读
        
      </div>
    </a>
  
  
    <a href="/2014/06/22/ApacheOFbizserviceengine源码解读/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">ApacheOFbizserviceengine源码解读</div>
    </a>
  
</nav>

  
</article>


  <section id="comments">
    <!-- 多说评论框 start -->
    <div class="ds-thread" data-thread-key="post-深入浅出JVM" data-title="深入浅出JVM" data-url="http://vinoyang.com/2014/09/03/深入浅出JVM/"></div>
    <!-- 多说评论框 end -->
    <!-- 多说公共JS代码 start (一个网页只需插入一次) -->
    <script type="text/javascript">
    var duoshuoQuery = {short_name:'vinoyang'};
      (function() {
        var ds = document.createElement('script');
        ds.type = 'text/javascript';ds.async = true;
        ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
        ds.charset = 'UTF-8';
        (document.getElementsByTagName('head')[0] 
         || document.getElementsByTagName('body')[0]).appendChild(ds);
      })();
      </script>
    <!-- 多说公共JS代码 end -->
  </section>
</section>
        
          <aside id="sidebar">
  
    
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/RabbitMQ/">RabbitMQ</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Zookeeper/">Zookeeper</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/async/">async</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/disque/">disque</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/docker/">docker</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/flume/">flume</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/messagebus/">messagebus</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/morphline/">morphline</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/rate-limit/">rate-limit</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/redis/">redis</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/分布式/">分布式</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/分布式锁/">分布式锁</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/日志系统/">日志系统</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/消息总线/">消息总线</a><span class="tag-list-count">3</span></li></ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/RabbitMQ/" style="font-size: 10px;">RabbitMQ</a> <a href="/tags/Zookeeper/" style="font-size: 13.33px;">Zookeeper</a> <a href="/tags/async/" style="font-size: 10px;">async</a> <a href="/tags/disque/" style="font-size: 10px;">disque</a> <a href="/tags/docker/" style="font-size: 10px;">docker</a> <a href="/tags/flume/" style="font-size: 16.67px;">flume</a> <a href="/tags/messagebus/" style="font-size: 10px;">messagebus</a> <a href="/tags/morphline/" style="font-size: 10px;">morphline</a> <a href="/tags/rate-limit/" style="font-size: 10px;">rate-limit</a> <a href="/tags/redis/" style="font-size: 16.67px;">redis</a> <a href="/tags/分布式/" style="font-size: 10px;">分布式</a> <a href="/tags/分布式锁/" style="font-size: 10px;">分布式锁</a> <a href="/tags/日志系统/" style="font-size: 20px;">日志系统</a> <a href="/tags/消息总线/" style="font-size: 16.67px;">消息总线</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/02/">二月 2016</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/12/">十二月 2015</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/11/">十一月 2015</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/10/">十月 2015</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/08/">八月 2015</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/07/">七月 2015</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/06/">六月 2015</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/05/">五月 2015</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/04/">四月 2015</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/03/">三月 2015</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/02/">二月 2015</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/01/">一月 2015</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/12/">十二月 2014</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/10/">十月 2014</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/09/">九月 2014</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/06/">六月 2014</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/04/">四月 2014</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/03/">三月 2014</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/02/">二月 2014</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2013/12/">十二月 2013</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2013/10/">十月 2013</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2013/09/">九月 2013</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2013/07/">七月 2013</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2013/05/">五月 2013</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2013/03/">三月 2013</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2013/02/">二月 2013</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2013/01/">一月 2013</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2012/12/">十二月 2012</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2012/11/">十一月 2012</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2012/09/">九月 2012</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2012/08/">八月 2012</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2012/06/">六月 2012</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2012/05/">五月 2012</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2012/04/">四月 2012</a><span class="archive-list-count">6</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2012/03/">三月 2012</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2012/02/">二月 2012</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2012/01/">一月 2012</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2011/12/">十二月 2011</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2011/11/">十一月 2011</a><span class="archive-list-count">6</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2011/10/">十月 2011</a><span class="archive-list-count">9</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2011/09/">九月 2011</a><span class="archive-list-count">8</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2011/08/">八月 2011</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2011/07/">七月 2011</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2011/06/">六月 2011</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2011/05/">五月 2011</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2011/03/">三月 2011</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2011/02/">二月 2011</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2010/07/">七月 2010</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2010/06/">六月 2010</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2010/05/">五月 2010</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2010/04/">四月 2010</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2010/03/">三月 2010</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2010/02/">二月 2010</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2010/01/">一月 2010</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2009/10/">十月 2009</a><span class="archive-list-count">4</span></li></ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recents</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2016/02/10/log-system-refactor-agent-with-multi-flow/">日志系统重构之多源聚合的采集器</a>
          </li>
        
          <li>
            <a href="/2016/02/07/collect-docker-container-log-with-flume/">日志系统之基于flume收集docker容器日志</a>
          </li>
        
          <li>
            <a href="/2015/12/26/link-log-system-component-with-zookeeper/">日志系统之基于Zookeeper的分布式协同设计</a>
          </li>
        
          <li>
            <a href="/2015/12/11/messagebus-refactor-model/">消息总线之模型重构</a>
          </li>
        
          <li>
            <a href="/2015/11/20/build-log-sys-with-flume-and-morphline/">日志系统之Flume采集加morphline解析</a>
          </li>
        
      </ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Weibo show</h3>
    <div class="widget-weibo">
      <iframe width="100%" height="450" class="share_self"  frameborder="0" scrolling="no" src="http://widget.weibo.com/weiboshow/index.php?language=&width=0&height=550&fansRow=2&ptype=1&speed=0&skin=2&isTitle=0&noborder=0&isWeibo=1&isFans=0&uid=1958166695&verifier=9c2d28b9&colors=dddddd,dddddd,666666,0069a4,dddddd&dpc=1"></iframe>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Github</h3>
    <div class="widget-github">
      <script data-name="yanghua" src="http://octocard.in/o.js"></script>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2016 yanghua1127@gmail.com<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
    <a href="/projects" class="mobile-nav-link">Projects</a>
  
    <a href="/about" class="mobile-nav-link">About</a>
  
</nav>
    

<script src="http://apps.bdimg.com/libs/jquery/2.0.3/jquery.min.js"></script>
<script type="text/javascript">
//<![CDATA[
if (typeof jQuery == 'undefined') {
  document.write(unescape("%3Cscript src='/js/jquery-2.0.3.min.js' type='text/javascript'%3E%3C/script%3E"));
}
// ]]>
</script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css" type="text/css">
  <script src="/fancybox/jquery.fancybox.pack.js" type="text/javascript"></script>


<script src="/js/script.js" type="text/javascript"></script>

<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "//hm.baidu.com/hm.js?36c1573c11e45ea0f6419af5f2f04760";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>
  </div>
</body>
</html>